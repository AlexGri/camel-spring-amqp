<?xml version="1.0" encoding="UTF-8"?>
<!--
  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Software distributed under the License is distributed on an "AS IS"
  basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  License for the specific language governing rights and limitations
  under the License.

  The Original Code is camel-spring-amqp.

  The Initial Developer of the Original Code is Bluelock, LLC.
  Copyright (c) 2007-2011 Bluelock, LLC. All Rights Reserved.
-->
<beans	xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:rabbit="http://www.springframework.org/schema/rabbit"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd
       http://www.springframework.org/schema/rabbit http://www.springframework.org/schema/rabbit/spring-rabbit-1.0.xsd">

    <context:annotation-config/>
    <context:component-scan base-package="amqp.spring.camel.component"/>

    <camelContext id="context" xmlns="http://camel.apache.org/schema/spring">
        <jmxAgent id="agent" createConnector="false" disabled="true"/>
        <template id="template"/>

        <route>
            <from uri="direct:stepOne"/>
            <to uri="spring-amqp:myExchange:test.m?type=direct&amp;durable=false&amp;autodelete=true&amp;exclusive=false"/>
        </route>
        
        <route>
            <from uri="spring-amqp:myExchange:myQueue:test.m?type=direct&amp;durable=false&amp;autodelete=true&amp;exclusive=false"/>
            <to uri="mock:testOne"/>
        </route>

        <route>
            <from uri="direct:stepTwo"/>
            <to uri="spring-amqp:magicExchange?type=headers&amp;durable=false&amp;autodelete=true&amp;exclusive=false"/>
        </route>
        
        <route>
            <from uri="spring-amqp:magicExchange:mysteryQ:key1=value1&amp;key2=value2?type=headers&amp;durable=false&amp;autodelete=true&amp;exclusive=false"/>
            <to uri="mock:testTwo"/>
        </route>
    </camelContext>
    
    <bean id="spring-amqp" class="amqp.spring.camel.component.SpringAMQPComponent"/>
    <bean id="jsonMessageConverter" class="org.springframework.amqp.support.converter.JsonMessageConverter"/>
    <rabbit:connection-factory id="connectionFactory"/>
    <rabbit:template id="amqpTemplate" connection-factory="connectionFactory" message-converter="jsonMessageConverter"/>
    <rabbit:admin connection-factory="connectionFactory"/>
</beans>
